<!DOCTYPE html>
<html lang="ko">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>분배 계산기</title>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css" rel="stylesheet">
	<link rel="stylesheet" href="styles.css">
	<link rel="icon" type="image/svg+xml" href="favicon.svg">
	<script defer src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</head>
<body>
	<div class="container">
		<div class="tabbar" id="tabbar">
			<div class="tabs-scroll" id="tabs-scroll">
				<div class="tabs" id="tabs"></div>
			</div>
			<button class="btn" id="btn-add-tab" aria-label="새 기록 추가">+ 새 기록</button>
			<button class="btn danger" id="btn-remove-tab" aria-label="현재 기록 삭제">기록 삭제</button>
		</div>
		<details class="input-panel" open>
			<summary>입력 패널 (접기/펼치기)</summary>
			<div class="panel-body">
				<div class="grid-2">
					<div class="section">
						<h3>기본 정보</h3>
						<div class="grid-3">
							<label class="field">
								<span>날짜</span>
								<input id="input-date" type="date" />
							</label>
							<label class="field col-span-2">
								<span>제목</span>
								<input id="input-title" type="text" placeholder="예) 혼테일 공대 알목 분배" />
							</label>
						</div>
					</div>
					<div class="section">
						<h3 style="margin-top:4px;">수입 항목</h3>
						<div id="income-list"></div>
						<div style="display:flex; gap:8px; margin-top:8px; flex-wrap:wrap;">
							<input id="new-income-label" type="text" placeholder="라벨(선택)" style="flex:1 1 160px;">
							<input id="new-income-gross" type="number" min="0" step="1" placeholder="전체금액" style="width:140px;">
							<input id="new-income-fee-rate" type="number" min="0" step="0.01" inputmode="decimal" placeholder="수수료율(%)" style="width:130px;">
							<button class="btn" id="btn-add-income" aria-label="수입 항목 추가">추가</button>
						</div>
						<div class="small" style="margin-top:6px;">수입 항목이 하나라도 있으면 위 단일 입력 대신 합산값을 사용합니다.</div>
					</div>
				</div>

				<div class="grid-2">
					<div class="section">
						<h3>인센티브 항목</h3>
						<div id="incentive-list"></div>
						<div style="display:flex; gap:8px; margin-top:8px;">
							<input id="new-incentive-label" type="text" placeholder="라벨" style="flex:1;">
							<input id="new-incentive-amount" type="number" min="0" step="1" placeholder="금액(+)">
							<button class="btn" id="btn-add-incentive" aria-label="인센티브 추가">추가</button>
						</div>
						<div class="small" style="margin-top:6px;">금액은 0 이상의 정수만 허용됩니다.</div>
					</div>
					<div class="section">
						<h3>MEMO</h3>
						<textarea id="input-memo" rows="7" placeholder="여러 줄 메모를 입력하세요. 인쇄 시 우측 박스에 표시됩니다."></textarea>
					</div>
				</div>

				<div class="section">
					<h3>공대원 목록</h3>
					<div id="member-list"></div>
					<div style="display:flex; gap:8px; margin-top:8px;">
						<input id="new-member-name" type="text" placeholder="이름" style="flex:1;">
						<input id="new-member-penalty" type="number" min="0" step="1" placeholder="사망 패널티(원)">
						<label style="display:flex; align-items:center; gap:6px;">
							<input id="new-member-exclude" type="checkbox"> 분배 제외
						</label>
						<input id="new-member-note" type="text" placeholder="메모(선택)" style="flex:1;">
						<button class="btn" id="btn-add-member" aria-label="공대원 추가">추가</button>
					</div>
					<div class="small" style="margin-top:6px;">사망 패널티는 음수 불가. 키보드로도 추가(Enter)/삭제(Del) 가능합니다.</div>
				</div>
			</div>
		</details>

		<div class="actions">
			<button class="btn danger" id="btn-reset" aria-label="모든 입력 초기화">초기화</button>
			<button class="btn" id="btn-save-png" aria-label="PNG 저장">PNG 저장</button>
			<button class="btn" id="btn-copy-png" aria-label="PNG 복사">PNG 복사</button>
			<button class="btn primary" id="btn-print" aria-label="PDF/인쇄">PDF/인쇄</button>
			<div class="small" style="margin-left:auto;">인쇄 시 브라우저 설정에서 “배경 그래픽 인쇄”를 켜주세요.</div>
		</div>

		<div id="printArea">
			<div class="header" id="header-title">-</div>
			<div class="sheet">
				<div>
					<table id="main-table">
						<thead>
							<tr>
								<th style="width:28%;">명단</th>
								<th style="width:14%;">기본 분배금</th>
								<th style="width:14%;">패널티</th>
								<th style="width:14%;">인센티브</th>
								<th style="width:14%;">패널티 분배</th>
								<th style="width:16%;">최종 분배금</th>
							</tr>
						</thead>
						<tbody id="table-body"></tbody>
						<tfoot>
							<tr class="total-row" id="total-row">
								<th>TOTAL</th>
								<td class="num" data-k="total-base"></td>
								<td class="num" data-k="total-penalty"></td>
								<td class="num" data-k="total-incentive"></td>
								<td class="num" data-k="total-penalty-dist"></td>
								<td class="num" data-k="total-final"></td>
							</tr>
						</tfoot>
					</table>
				</div>
			</div>

			<div class="footer">
				<div>
					<table class="summary-table">
						<thead>
							<tr>
								<th>항목</th>
								<th>전체금액</th>
								<th>수수료 제외 금액</th>
								<th>인센티브</th>
							</tr>
						</thead>
						<tbody id="summary-body"></tbody>
						<tfoot>
							<tr>
								<th>합계</th>
								<th class="num" id="sum-gross">0</th>
								<th class="num" id="sum-net">0</th>
								<th class="num" id="sum-incentive">0</th>
							</tr>
						</tfoot>
					</table>
					<div class="kpi">
						<div class="tile">
							<div class="label">수입 총액</div>
							<div class="value" id="kpi-income">0</div>
						</div>
						<div class="tile">
							<div class="label">분배 총액</div>
							<div class="value" id="kpi-distributable">0</div>
						</div>
						<div class="tile">
							<div class="label">분배 인원</div>
							<div class="value" id="kpi-count">0</div>
						</div>
						<div class="tile">
							<div class="label">인당 분배금(기본)</div>
							<div class="value" id="kpi-per-head">0</div>
						</div>
					</div>
				</div>
				<div class="memo-box">
					<h4>MEMO</h4>
					<div class="memo-content" id="memo-render-bottom"></div>
				</div>
			</div>
		</div>
	</div>

	<script type="module" defer src="app.js"></script>
</body>
</html>


